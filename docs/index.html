<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Final Project</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h2 id="toc_0">Soil Moister - Final Project</h2>

<p>Geoffrey Campbell<br>
GEOG 490<br>
Patrick Bartlein<br>
6/13/2019  </p>

<p>The data contains information about global soil moisture from 1948/01 to 2019/05<br>
The Data comes from the ESRL website.  <a href="https://www.esrl.noaa.gov/psd/data/gridded/data.cpcsoil.html">Link to data</a></p>

<ol>
<li>This project aims to... 

<ol>
<li>Map the global soil moisture around the world.</li>
<li>Show any changes of global soil moisture over the past 72 years.</li>
<li>Display the monthly variations of global soil moisture.</li>
</ol></li>
</ol>

<h3 id="toc_1">Load the required packages</h3>

<div><pre><code class="language-none">library(sf) 
library(ncdf4)
library(raster)
library(rasterVis)
library(RColorBrewer)
library(ncdf.tools)
library(ggplot2)
library(ggthemes)
library(zoo)  </code></pre></div>

<h3 id="toc_2">Load the netCDF data</h3>

<div><pre><code class="language-none">shp_path &lt;- &quot;C:/Users/Geoffrey/Documents/Rdata/&quot;
shp_name &lt;- &quot;ne_110m_admin_0_countries.shp&quot;
shp_file &lt;- paste(shp_path, shp_name, sep=&quot;&quot;)

ncpath &lt;- &quot;C:/Users/Geoffrey/Documents/Rdata/&quot;
ncname &lt;- &quot;soilw.mon.ltm.v2.nc&quot;  
ncfname &lt;- paste(ncpath, ncname, sep=&quot;&quot;)
soil &lt;- raster(ncfname, varname=&quot;soilw&quot;)</code></pre></div>

<h3 id="toc_3">This code creates a soil moisture map of the world.</h3>

<div><pre><code class="language-none">ncin &lt;- nc_open(ncfname)
print(ncin)

lon &lt;- ncvar_get(ncin,&quot;lon&quot;)
nlon &lt;- dim(lon)
head(lon)

lat &lt;- ncvar_get(ncin,&quot;lat&quot;)
nlat &lt;- dim(lat)
head(lat)

time &lt;- ncvar_get(ncin,&quot;time&quot;)
tunits &lt;- ncatt_get(ncin,&quot;time&quot;,&quot;units&quot;)
nt &lt;- dim(time)
print (c(nlon, nlat, nt))

tustr &lt;- strsplit(tunits$value, &quot; &quot;)
ptime &lt;- convertDateNcdf2R(time, unlist(tustr)[1], 
                       origin = as.POSIXct(unlist(tustr)[3],                                                    tz = &quot;UTC&quot;), time.format = &quot;%Y-%m-%d&quot;)
head(time); tail(time)

head(ptime); tail(ptime)

soil_mon &lt;- ncvar_get(ncin,dname_mon)
dlname_mon &lt;- ncatt_get(ncin,dname_mon,&quot;long_name&quot;)
dunits_mon &lt;- ncatt_get(ncin,dname_mon,&quot;units&quot;)
fillvalue_mon &lt;- ncatt_get(ncin,dname_mon,&quot;_FillValue&quot;)
dim(soil_mon)

nc_close(ncin)

temp_lat &lt;- rep(NA, nlat)
temp_lat[1:nlat] &lt;- lat[nlat:1]
temp_lat

lat &lt;- temp_lat

temp_array &lt;- array(NA, dim = c(nlon, nlat, nt))
temp_array[1:nlon, 1:nlat, 1:nt] &lt;-  soil_mon[1:nlon, nlat:1, 1:nt] 
soil_mon &lt;- temp_array

temp_lon &lt;- rep(NA, nlon)
temp_lon[1:(nlon/2)] &lt;-  lon[((nlon/2)+1):nlon] - 360.0
temp_lon[((nlon/2)+1):nlon] &lt;-  lon[1:(nlon/2)]
temp_lon
lon &lt;- temp_lon

temp_array &lt;- array(NA, dim = c(nlon, nlat, nt))
temp_array[1:(nlon/2), 1:nlat, 1:nt] &lt;-  soil_mon[((nlon/2)+1):nlon,    nlat:1, 1:nt] 
temp_array[((nlon/2)+1):nlon, 1:nlat, 1:nt] &lt;-  soil_mon[1:(nlon/2), nlat:1, 1:nt]
soil_mon &lt;- temp_array

n &lt;- 2
grid &lt;- expand.grid(lon=lon, lat=lat)
levelplot(soil_mon[,, n] ~ lon * lat, data=grid, cuts=11, pretty=T, 
      col.regions=(rev(brewer.pal(10,&quot;Reds&quot;))))</code></pre></div>

<h3 id="toc_4">Result</h3>

<h3 id="toc_5">1981 Janurary (Red to White: Low Moisture to High Moisture)</h3>

<p><img src="Soilmoisture.png" alt=""></p>

<h3 id="toc_6">When looking at this map. Soil moisture values seems to be high when it&#39;s in an area where it does not lack precipitation values such as the Amazon and East Asia and low when it&#39;s in an area with low precipitation values such as the Arctic and Persian Gulf.</h3>

<h3 id="toc_7">This is the code to produce a plot that shows the monthly soil variations</h3>

<div><pre><code class="language-none">monthly &lt;- stack(ncfname)
names(monthly) &lt;- c(&quot;Dec&quot;,&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;)

pngfile &lt;- &quot;months.png&quot;
png(pngfile, width=729, height=729)
levelplot(monthly , cuts=11, pretty=T, 
            col.regions=(rev(brewer.pal(10,&quot;RdBu&quot;))))</code></pre></div>

<h3 id="toc_8">Result</h3>

<h3 id="toc_9">1981 Janurary (Blue to Red: Low Moisture to High Moisture)</h3>

<p><img src="months.png" alt=""></p>

<h3 id="toc_10">Upon closer inspection.  We can see multiple regions soil moisture rates have a noticeable change throughout the year such as Northern Europe, India, Sub-Saharan Africa, and South America. Regions that don&#39;t have any noticeable changes can also be seen on the map such as the Urals, Persian Gulf, and Australia. This can be partly explained by the regions varied precipitation rates. Regions that don&#39;t have low precipitation rates and have a wet and dry season can be seen on the map. While regions that have very low or no precipitation rates can be seen maintain a single color monthly.</h3>

<h3 id="toc_11">This is the code that compares Janurary 1948 to Janurary 2019</h3>

<div><pre><code class="language-none">ncin &lt;- nc_open(ncfname)
lon &lt;- ncvar_get(ncin,&quot;lon&quot;)
nlon &lt;- dim(lon)
lat &lt;- ncvar_get(ncin,&quot;lat&quot;)
nlat &lt;- dim(lat)

time &lt;- ncvar_get(ncin,&quot;time&quot;)
tunits &lt;- ncatt_get(ncin,&quot;time&quot;,&quot;units&quot;)
nt &lt;- dim(time)

soil_array &lt;- ncvar_get(ncin,dname)
dlname &lt;- ncatt_get(ncin,dname,&quot;long_name&quot;)
dunits &lt;- ncatt_get(ncin,dname,&quot;units&quot;)
fillvalue &lt;- ncatt_get(ncin,dname,&quot;_FillValue&quot;)

m &lt;- 1
soil_slice &lt;- soil_array[,,m]

image(soil_slice, col=rev(brewer.pal(10,&quot;RdBu&quot;)))

m &lt;- 852
soil_slice &lt;- soil_array[,,m]

image(soil_slice, col=rev(brewer.pal(10,&quot;RdBu&quot;)))</code></pre></div>

<h3 id="toc_12">Result</h3>

<h3 id="toc_13">1948 Janurary (Blue to Red: Low Moisture to High Moisture)</h3>

<p><img src="1948Jan.jpeg" alt=""></p>

<h3 id="toc_14">2019 Janurary (Blue to Red: Low Moisture to High Moisture)</h3>

<p><img src="2019Jan.jpeg" alt=""></p>

<h3 id="toc_15">After the 72 year difference, several things can be noticed that can be attributed to phenomenons today. The soil moisture in the Amazon Rain Forest and Sub Saharan Africa has significantly grown weaker over the past 72 years. This can be possibly attribted to anthropogenic actitivities such as urbanization and logging leaving less capicity for soil moisture. In contrast, an increase in soil moisture can be seen in the North East of the United States. This can be possibly explained by the reforestation trend that has been occuring over the past 100 years in that region when agriculture was replaced by urbanization leaving areas to be naturally reforested.</h3>




</body>

</html>
